Алгоритм Манакера $O(N)$  
$d1$ - палиндромы нечетной длины  
$d2$ - палиндромы четной длины