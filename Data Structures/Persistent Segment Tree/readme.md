Персистентное дерево отрезков
1. $a[x]$ += $y$ $O(logN)$
2. $sum(l, r)$ в версии $i$ $O(logN)$