Historic segment tree $O(NlogN)$