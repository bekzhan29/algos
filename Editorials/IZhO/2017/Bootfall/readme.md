# Bootfall
Во-первых сила Тимы будет целым числом от $1$ до $S$, где $S=\sum a[i]$. Если его сила будет больше чем сумма сил всех остальных игроков, то раунды в которых он участвует не будут ничейными, так как команда в которой будет Тима победит.

Проверим будет ли раунд в котором Тима снимает на видео ничейным. Во-первых $S$ должно быть четным, во-вторых сила каждой команды должна быть $S/2$. Напишем рюкзак и проверим что можно собрать сумму $S/2$. Если этот раунд не ничейный, то неважно какую силу выберет Тима, поэтому можем вывести $0$ и остановить программу. Иначе надо понять какую силу может выбрать Тима.

## Подзадачи 1-3
Заведем массив $ans[x]$, который хранит `true` или `false` в зависимости от того может ли Тима выбрать силу $x$, чтобы все игры были ничейными. Изначально $ans[i]=true$ для всех $i$ от $1$ до $S$.

Найдем какую силу может выбрать Тима, если игрок $i$ будет снимать на видео. Посчитаем с помощью рюкзака какие сумммы можно собрать без игрока $i$. Заведем новый массив $can[x]$, где будет храниться `true` если игра будет ничейной когда сила Тимы равна $x$ и игрок $i$ снимает на видео, и `false` иначе. Тогда если сила первой команды $x$ и сила второй команды $y$. Тогда Тима должен присоединиться к более слабой команде и выбрать силу $|y-x|$. Тогда раунд будет ничейным. Переберем все возможные $x$, которые можно собрать, тогда $y=S-x-a[i]$ и присвоим $can[|y-x|]=true$. Теперь обновим массив $ans$, если $can[x]=false$, то надо сделать $ans[x]=false$. В конце выведем все значения $x$ для которых $ans[x]=true$.

Время работы $O(N^2S)$, так как надо посчитать рюкзак для каждого раунда.

## Подзадачи 4-5
Приведенное выше решение можно реализовать битсетом.

Время работы $O(N^2S/64)$.

## Полное решение
В рюкзаке $dp[x]$ будет хранить количество способов собрать команду с силой $x$ по какому-то рандомному простому модулю. Посчитаем этот рюкзак для раунда когда Тима снимает на видео. Теперь посчитаем $dp2[x]$ которое хранит количество способов собрать команду с силой $x$ когда игрок $i$ снимает на камеру. Допустим мы уже посчитали $dp2$ для всех чисел от $0$ до $x-1$ и хотим посчитать для $x$. Тогда $dp2[x]=dp[x]-dp2[x-a[i]]$. Почему это так? $dp[x]$ хранит способы в которых есть игрок $i$ и в которых его нет. Сколько есть способов собрать $x$, в которых есть игрок $i$? Их ровно $dp2[x-a[i]]$. Теперь мы можем собрать команду с силой $x$ если $dp2[x]>0$. Идентично прошлому решению считаем массив $can$ и обновляем массив $ans$. Могут быть случаи когда $dp2[x]=0$, но мы можем собрать команду с силой $x$, тогда посчитаем рюкзак по 2 разным модулям.

Время работы $O(N^3)$.